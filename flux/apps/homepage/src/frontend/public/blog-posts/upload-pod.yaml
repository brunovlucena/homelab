apiVersion: v1
kind: Pod
metadata:
  name: upload-three-scales
  namespace: default
spec:
  restartPolicy: Never
  containers:
    - name: upload
      image: alpine:latest
      command:
        - /bin/sh
        - -c
        - |
          # Install MinIO client
          apk add --no-cache curl
          curl -o /tmp/mc https://dl.min.io/client/mc/release/linux-amd64/mc
          chmod +x /tmp/mc
          mv /tmp/mc /usr/local/bin/mc || cp /tmp/mc /usr/bin/mc && chmod +x /usr/bin/mc
          
          echo "‚è≥ Waiting for upload command..."
          # Keep container running
          tail -f /dev/null
      env:
        - name: MINIO_ACCESS_KEY
          valueFrom:
            secretKeyRef:
              name: minio-credentials
              key: access-key
        - name: MINIO_SECRET_KEY
          valueFrom:
            secretKeyRef:
              name: minio-credentials
              key: secret-key
      volumeMounts:
        - name: tmp
          mountPath: /tmp
  volumes:
    - name: tmp
      emptyDir: {}
