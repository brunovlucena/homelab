---
apiVersion: v1
kind: ConfigMap
metadata:
  name: homepage-security-dashboard
  namespace: prometheus
  labels:
    grafana_dashboard: "1"
    app.kubernetes.io/name: homepage
    app.kubernetes.io/component: security-dashboard
  annotations:
    k8s-sidecar-target-directory: "Homepage"
data:
  homepage-security-dashboard.json: |
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": {
              "type": "grafana",
              "uid": "-- Grafana --"
            },
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "type": "dashboard"
          },
          {
            "datasource": {
              "type": "prometheus",
              "uid": "prometheus"
            },
            "enable": true,
            "expr": "ALERTS{alertname=~\"Homepage.*\", severity=\"critical\"}",
            "iconColor": "red",
            "name": "Critical Alerts",
            "step": "60s",
            "titleFormat": "{{ alertname }}"
          },
          {
            "datasource": {
              "type": "prometheus",
              "uid": "prometheus"
            },
            "enable": true,
            "expr": "ALERTS{alertname=~\"Homepage.*\", severity=\"warning\"}",
            "iconColor": "orange",
            "name": "Warning Alerts",
            "step": "60s",
            "titleFormat": "{{ alertname }}"
          }
        ]
      },
      "description": "Comprehensive security monitoring dashboard for Homepage (lucena.cloud) - SEC-013",
      "editable": true,
      "fiscalYearStartMonth": 0,
      "graphTooltip": 1,
      "id": null,
      "links": [
        {
          "asDropdown": false,
          "icon": "external link",
          "includeVars": false,
          "keepTime": true,
          "tags": [],
          "targetBlank": true,
          "title": "Homepage Metrics",
          "tooltip": "Homepage performance metrics",
          "type": "link",
          "url": "/d/homepage-metrics"
        }
      ],
      "liveNow": false,
      "panels": [
        {
          "collapsed": false,
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 0 },
          "id": 100,
          "panels": [],
          "title": "Security Overview",
          "type": "row"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "mappings": [
                { "options": { "0": { "color": "green", "index": 0, "text": "SECURE" } }, "type": "value" },
                { "options": { "from": 1, "result": { "color": "red", "index": 1, "text": "ALERT" }, "to": 999999 }, "type": "range" }
              ],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "red", "value": 1 }] }
            },
            "overrides": []
          },
          "gridPos": { "h": 4, "w": 4, "x": 0, "y": 1 },
          "id": 1,
          "options": { "colorMode": "background", "graphMode": "none", "justifyMode": "auto", "orientation": "auto", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }, "textMode": "auto" },
          "pluginVersion": "10.0.0",
          "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "count(ALERTS{alertname=~\"Homepage.*\", alertstate=\"firing\", severity=\"critical\"})", "refId": "A" }],
          "title": "Security Status",
          "type": "stat"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }, { "color": "red", "value": 5 }] }
            },
            "overrides": []
          },
          "gridPos": { "h": 4, "w": 4, "x": 4, "y": 1 },
          "id": 2,
          "options": { "colorMode": "value", "graphMode": "area", "justifyMode": "auto", "orientation": "auto", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }, "textMode": "auto" },
          "pluginVersion": "10.0.0",
          "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "count(ALERTS{alertname=~\"Homepage.*\", alertstate=\"firing\"})", "refId": "A" }],
          "title": "Active Alerts",
          "type": "stat"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 0.1 }, { "color": "red", "value": 1 }] },
              "unit": "reqps"
            },
            "overrides": []
          },
          "gridPos": { "h": 4, "w": 4, "x": 8, "y": 1 },
          "id": 3,
          "options": { "colorMode": "value", "graphMode": "area", "justifyMode": "auto", "orientation": "auto", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }, "textMode": "auto" },
          "pluginVersion": "10.0.0",
          "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum(rate(nginx_http_requests_total{namespace=\"homepage\",status=\"403\"}[5m])) or vector(0)", "refId": "A" }],
          "title": "Blocked Requests/s",
          "type": "stat"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 0.1 }, { "color": "red", "value": 0.5 }] },
              "unit": "reqps"
            },
            "overrides": []
          },
          "gridPos": { "h": 4, "w": 4, "x": 12, "y": 1 },
          "id": 4,
          "options": { "colorMode": "value", "graphMode": "area", "justifyMode": "auto", "orientation": "auto", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }, "textMode": "auto" },
          "pluginVersion": "10.0.0",
          "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum(rate(nginx_http_requests_total{namespace=\"homepage\",status=\"429\"}[5m])) or vector(0)", "refId": "A" }],
          "title": "Rate Limited/s",
          "type": "stat"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 0.1 }, { "color": "red", "value": 0.5 }] },
              "unit": "reqps"
            },
            "overrides": []
          },
          "gridPos": { "h": 4, "w": 4, "x": 16, "y": 1 },
          "id": 5,
          "options": { "colorMode": "value", "graphMode": "area", "justifyMode": "auto", "orientation": "auto", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }, "textMode": "auto" },
          "pluginVersion": "10.0.0",
          "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum(rate(nginx_http_requests_total{namespace=\"homepage\",status=\"401\"}[5m])) or vector(0)", "refId": "A" }],
          "title": "Auth Failures/s",
          "type": "stat"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 0.05 }, { "color": "red", "value": 0.1 }] },
              "unit": "percentunit"
            },
            "overrides": []
          },
          "gridPos": { "h": 4, "w": 4, "x": 20, "y": 1 },
          "id": 6,
          "options": { "colorMode": "value", "graphMode": "area", "justifyMode": "auto", "orientation": "auto", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }, "textMode": "auto" },
          "pluginVersion": "10.0.0",
          "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "(sum(rate(nginx_http_requests_total{namespace=\"homepage\",status=~\"4..|5..\"}[5m])) / sum(rate(nginx_http_requests_total{namespace=\"homepage\"}[5m]))) or vector(0)", "refId": "A" }],
          "title": "Error Rate",
          "type": "stat"
        },
        {
          "collapsed": false,
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 5 },
          "id": 101,
          "panels": [],
          "title": "Security Events Timeline",
          "type": "row"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": { "axisCenteredZero": false, "axisColorMode": "text", "axisLabel": "Requests/s", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 20, "gradientMode": "none", "hideFrom": { "legend": false, "tooltip": false, "viz": false }, "lineInterpolation": "smooth", "lineWidth": 2, "pointSize": 5, "scaleDistribution": { "type": "linear" }, "showPoints": "never", "spanNulls": false, "stacking": { "group": "A", "mode": "none" }, "thresholdsStyle": { "mode": "line" } },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "red", "value": 1 }] },
              "unit": "reqps"
            },
            "overrides": [
              { "matcher": { "id": "byName", "options": "403 Forbidden" }, "properties": [{ "id": "color", "value": { "fixedColor": "red", "mode": "fixed" } }] },
              { "matcher": { "id": "byName", "options": "429 Rate Limited" }, "properties": [{ "id": "color", "value": { "fixedColor": "orange", "mode": "fixed" } }] },
              { "matcher": { "id": "byName", "options": "401 Unauthorized" }, "properties": [{ "id": "color", "value": { "fixedColor": "yellow", "mode": "fixed" } }] },
              { "matcher": { "id": "byName", "options": "400 Bad Request" }, "properties": [{ "id": "color", "value": { "fixedColor": "purple", "mode": "fixed" } }] }
            ]
          },
          "gridPos": { "h": 8, "w": 24, "x": 0, "y": 6 },
          "id": 7,
          "options": { "legend": { "calcs": ["lastNotNull", "max", "mean"], "displayMode": "table", "placement": "bottom", "showLegend": true }, "tooltip": { "mode": "multi", "sort": "desc" } },
          "pluginVersion": "10.0.0",
          "targets": [
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum(rate(nginx_http_requests_total{namespace=\"homepage\",status=\"403\"}[5m])) or vector(0)", "legendFormat": "403 Forbidden", "refId": "A" },
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum(rate(nginx_http_requests_total{namespace=\"homepage\",status=\"429\"}[5m])) or vector(0)", "legendFormat": "429 Rate Limited", "refId": "B" },
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum(rate(nginx_http_requests_total{namespace=\"homepage\",status=\"401\"}[5m])) or vector(0)", "legendFormat": "401 Unauthorized", "refId": "C" },
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum(rate(nginx_http_requests_total{namespace=\"homepage\",status=\"400\"}[5m])) or vector(0)", "legendFormat": "400 Bad Request", "refId": "D" }
          ],
          "title": "Security Events Over Time",
          "type": "timeseries"
        },
        {
          "collapsed": false,
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 14 },
          "id": 102,
          "panels": [],
          "title": "Attack Detection",
          "type": "row"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": { "axisCenteredZero": false, "axisColorMode": "text", "axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "bars", "fillOpacity": 100, "gradientMode": "none", "hideFrom": { "legend": false, "tooltip": false, "viz": false }, "lineInterpolation": "linear", "lineWidth": 1, "pointSize": 5, "scaleDistribution": { "type": "linear" }, "showPoints": "never", "spanNulls": false, "stacking": { "group": "A", "mode": "normal" }, "thresholdsStyle": { "mode": "off" } },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 15 },
          "id": 8,
          "options": { "legend": { "calcs": ["sum"], "displayMode": "table", "placement": "bottom", "showLegend": true }, "tooltip": { "mode": "multi", "sort": "desc" } },
          "pluginVersion": "10.0.0",
          "targets": [
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "increase(nginx_http_requests_total{namespace=\"homepage\",status=\"403\",request_uri=~\".*wp-admin.*|.*wp-login.*|.*phpmyadmin.*\"}[1h]) or vector(0)", "legendFormat": "WordPress/PHP Probes", "refId": "A" },
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "increase(nginx_http_requests_total{namespace=\"homepage\",status=\"403\",request_uri=~\".*\\\\.env.*|.*\\\\.git.*|.*\\\\.svn.*\"}[1h]) or vector(0)", "legendFormat": "Config File Probes", "refId": "B" },
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "increase(nginx_http_requests_total{namespace=\"homepage\",status=\"403\",request_uri=~\".*union.*|.*select.*|.*drop.*\"}[1h]) or vector(0)", "legendFormat": "SQL Injection", "refId": "C" },
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "increase(nginx_http_requests_total{namespace=\"homepage\",status=\"403\",request_uri=~\".*script.*|.*javascript.*\"}[1h]) or vector(0)", "legendFormat": "XSS Attempts", "refId": "D" }
          ],
          "title": "Attack Patterns Detected (Last Hour)",
          "type": "timeseries"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 10 }, { "color": "red", "value": 50 }] },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 12, "y": 15 },
          "id": 9,
          "options": { "displayMode": "gradient", "minVizHeight": 10, "minVizWidth": 0, "orientation": "horizontal", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }, "showUnfilled": true, "valueMode": "color" },
          "pluginVersion": "10.0.0",
          "targets": [
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "increase(nginx_http_requests_total{namespace=\"homepage\",status=\"403\"}[24h]) or vector(0)", "legendFormat": "Blocked (403)", "refId": "A" },
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "increase(nginx_http_requests_total{namespace=\"homepage\",status=\"429\"}[24h]) or vector(0)", "legendFormat": "Rate Limited (429)", "refId": "B" },
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "increase(nginx_http_requests_total{namespace=\"homepage\",status=\"401\"}[24h]) or vector(0)", "legendFormat": "Auth Failed (401)", "refId": "C" },
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "increase(nginx_http_requests_total{namespace=\"homepage\",status=\"400\"}[24h]) or vector(0)", "legendFormat": "Bad Request (400)", "refId": "D" }
          ],
          "title": "Security Events (24h Total)",
          "type": "bargauge"
        },
        {
          "collapsed": false,
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 23 },
          "id": 103,
          "panels": [],
          "title": "Rate Limiting & Access Control",
          "type": "row"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": { "axisCenteredZero": false, "axisColorMode": "text", "axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 10, "gradientMode": "none", "hideFrom": { "legend": false, "tooltip": false, "viz": false }, "lineInterpolation": "linear", "lineWidth": 2, "pointSize": 5, "scaleDistribution": { "type": "linear" }, "showPoints": "never", "spanNulls": false, "stacking": { "group": "A", "mode": "none" }, "thresholdsStyle": { "mode": "line" } },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "red", "value": 10 }] },
              "unit": "reqps"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 24 },
          "id": 10,
          "options": { "legend": { "calcs": ["lastNotNull", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true }, "tooltip": { "mode": "multi", "sort": "none" } },
          "pluginVersion": "10.0.0",
          "targets": [
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum(rate(nginx_http_requests_total{namespace=\"homepage\"}[5m])) or vector(0)", "legendFormat": "Total Requests", "refId": "A" },
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum(rate(nginx_http_requests_total{namespace=\"homepage\",status=\"429\"}[5m])) or vector(0)", "legendFormat": "Rate Limited", "refId": "B" }
          ],
          "title": "Request Rate vs Rate Limited",
          "type": "timeseries"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": { "axisCenteredZero": false, "axisColorMode": "text", "axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 10, "gradientMode": "none", "hideFrom": { "legend": false, "tooltip": false, "viz": false }, "lineInterpolation": "linear", "lineWidth": 2, "pointSize": 5, "scaleDistribution": { "type": "linear" }, "showPoints": "never", "spanNulls": false, "stacking": { "group": "A", "mode": "none" }, "thresholdsStyle": { "mode": "off" } },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
              "unit": "reqps"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 12, "y": 24 },
          "id": 11,
          "options": { "legend": { "calcs": ["lastNotNull", "max"], "displayMode": "table", "placement": "bottom", "showLegend": true }, "tooltip": { "mode": "multi", "sort": "desc" } },
          "pluginVersion": "10.0.0",
          "targets": [
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum(rate(nginx_http_requests_total{namespace=\"homepage\",request_uri=~\"/api/.*\"}[5m])) by (request_uri) or vector(0)", "legendFormat": "{{ request_uri }}", "refId": "A" }
          ],
          "title": "API Endpoint Request Rates",
          "type": "timeseries"
        },
        {
          "collapsed": false,
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 32 },
          "id": 104,
          "panels": [],
          "title": "Cloudflare Edge Security",
          "type": "row"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "palette-classic" },
              "custom": { "axisCenteredZero": false, "axisColorMode": "text", "axisLabel": "", "axisPlacement": "auto", "barAlignment": 0, "drawStyle": "line", "fillOpacity": 10, "gradientMode": "none", "hideFrom": { "legend": false, "tooltip": false, "viz": false }, "lineInterpolation": "linear", "lineWidth": 2, "pointSize": 5, "scaleDistribution": { "type": "linear" }, "showPoints": "never", "spanNulls": false, "stacking": { "group": "A", "mode": "none" }, "thresholdsStyle": { "mode": "off" } },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] },
              "unit": "reqps"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 12, "x": 0, "y": 33 },
          "id": 12,
          "options": { "legend": { "calcs": ["lastNotNull", "mean"], "displayMode": "table", "placement": "bottom", "showLegend": true }, "tooltip": { "mode": "multi", "sort": "none" } },
          "pluginVersion": "10.0.0",
          "targets": [
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum(rate(cloudflare_zone_requests_total{zone=\"lucena.cloud\"}[5m])) or vector(0)", "legendFormat": "Total Edge Requests", "refId": "A" },
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "sum(rate(nginx_http_requests_total{namespace=\"homepage\"}[5m])) or vector(0)", "legendFormat": "Origin Requests", "refId": "B" }
          ],
          "title": "Cloudflare vs Origin Traffic",
          "type": "timeseries",
          "description": "Compare edge traffic (Cloudflare) vs origin traffic. Lower origin = better cache/security filtering."
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "mappings": [],
              "max": 100,
              "min": 0,
              "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 50 }, { "color": "green", "value": 80 }] },
              "unit": "percent"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 6, "x": 12, "y": 33 },
          "id": 13,
          "options": { "orientation": "auto", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }, "showThresholdLabels": false, "showThresholdMarkers": true },
          "pluginVersion": "10.0.0",
          "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "((sum(rate(cloudflare_zone_requests_total{zone=\"lucena.cloud\"}[5m])) - sum(rate(nginx_http_requests_total{namespace=\"homepage\"}[5m]))) / sum(rate(cloudflare_zone_requests_total{zone=\"lucena.cloud\"}[5m])) * 100) or vector(0)", "refId": "A" }],
          "title": "Edge Protection Rate",
          "type": "gauge",
          "description": "Percentage of traffic filtered/cached at Cloudflare edge before reaching origin."
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 10 }, { "color": "red", "value": 100 }] },
              "unit": "short"
            },
            "overrides": []
          },
          "gridPos": { "h": 8, "w": 6, "x": 18, "y": 33 },
          "id": 14,
          "options": { "displayMode": "gradient", "minVizHeight": 10, "minVizWidth": 0, "orientation": "horizontal", "reduceOptions": { "calcs": ["lastNotNull"], "fields": "", "values": false }, "showUnfilled": true, "valueMode": "color" },
          "pluginVersion": "10.0.0",
          "targets": [
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "increase(cloudflare_zone_requests_total{zone=\"lucena.cloud\",waf_action=\"block\"}[24h]) or vector(0)", "legendFormat": "WAF Blocked", "refId": "A" },
            { "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "increase(cloudflare_zone_requests_total{zone=\"lucena.cloud\",bot_management_decision=\"block\"}[24h]) or vector(0)", "legendFormat": "Bot Blocked", "refId": "B" }
          ],
          "title": "Cloudflare Security Actions (24h)",
          "type": "bargauge"
        },
        {
          "collapsed": false,
          "gridPos": { "h": 1, "w": 24, "x": 0, "y": 41 },
          "id": 105,
          "panels": [],
          "title": "Active Alerts",
          "type": "row"
        },
        {
          "datasource": { "type": "prometheus", "uid": "prometheus" },
          "fieldConfig": {
            "defaults": {
              "color": { "mode": "thresholds" },
              "custom": { "align": "auto", "cellOptions": { "type": "auto" }, "inspect": false },
              "mappings": [],
              "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }] }
            },
            "overrides": [
              {
                "matcher": { "id": "byName", "options": "severity" },
                "properties": [
                  { "id": "custom.cellOptions", "value": { "mode": "gradient", "type": "color-background" } },
                  { "id": "mappings", "value": [{ "options": { "critical": { "color": "red", "index": 0 }, "warning": { "color": "orange", "index": 1 }, "info": { "color": "blue", "index": 2 } }, "type": "value" }] }
                ]
              }
            ]
          },
          "gridPos": { "h": 8, "w": 24, "x": 0, "y": 42 },
          "id": 17,
          "options": { "cellHeight": "sm", "footer": { "countRows": false, "fields": "", "reducer": ["sum"], "show": false }, "showHeader": true },
          "pluginVersion": "10.0.0",
          "targets": [{ "datasource": { "type": "prometheus", "uid": "prometheus" }, "expr": "ALERTS{alertname=~\"Homepage.*\", alertstate=\"firing\"}", "format": "table", "instant": true, "refId": "A" }],
          "title": "Active Homepage Security Alerts",
          "transformations": [{ "id": "filterFieldsByName", "options": { "include": { "names": ["alertname", "severity", "security_category", "threat_type"] } } }],
          "type": "table"
        }
      ],
      "refresh": "30s",
      "schemaVersion": 38,
      "style": "dark",
      "tags": ["homepage", "security", "monitoring", "sec-013"],
      "templating": { "list": [] },
      "time": { "from": "now-6h", "to": "now" },
      "timepicker": { "refresh_intervals": ["5s", "10s", "30s", "1m", "5m", "15m", "30m", "1h", "2h", "1d"] },
      "timezone": "",
      "title": "Homepage Security Monitoring",
      "uid": "homepage-security",
      "version": 1,
      "weekStart": ""
    }
