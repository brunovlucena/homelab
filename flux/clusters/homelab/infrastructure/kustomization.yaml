apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# This kustomization deploys all infrastructure components EXCEPT:
# - repositories (deployed in phase1-core)
# - prometheus-operator (deployed in phase2-prometheus)
# - knative-operator (deployed in phase3-knative)
# Those are deployed separately to ensure CRDs are available before dependent components

resources:
  # Core infrastructure (CRDs from prometheus-operator are now available)
  - cert-manager
  - metrics-server
  - minio
  - loki
  - alloy
  - tempo
  - prometheus-pushgateway
  # Application infrastructure (Knative CRDs are now available)
  - knative-serving
  - knative-eventing
  - postgres
  - redis
  - mongodb
  # Applications
  - homepage
  # Agent-specific components
  - cloudflare-tunnel
  - agent-bruno
  # - agent-sre
  # - agent-jamie
  # Other components
  - headlamp
  - k6-operator